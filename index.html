<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="cdn-icons-png.flaticon.com/512/2237/2237440.png" type="favicon.png">
    <link rel="stylesheet" href="index.css">
    <title>Controle de Ponto</title>
</head>
<body>
    <header>
        <div class="header-container">
            <h1>Bate-Ponto</h1>
        </div>
    </header>

    <div class="data_hora">
        <h1>Data e Hora Atual:</h1>
        <p id="data"></p>
        <p id="hora"></p>
    </div>
    <button class="botao_ponto">Registrar Ponto</button>

    <div id="overlay"></div>    <!--Inicio aqui o fundo para quando o dialog for aberto e ter animacao-->

    <dialog id="dialog">
        <div class="dialog-header">
            <h1>Data e Hora Atual</h1>
            <button id="fechar">X</button>
        </div>
        <div class="dialog-content">
            <p id="data-dialog"></p>
            <p id="hora-dialog"></p>
            <button id="entrada">Registrar Entrada</button>
            <button id="saida">Registrar Sa√≠da</button>
        </div>
    </dialog>

    <footer>
        <p>Desenvolvido por Raul Fragoso</p>
        <a href="https://github.com/1harz" target="_blank"><img src="https://raw.githubusercontent.com/gilbarbara/logos/main/logos/github-icon.svg" alt="Logo GitHub que redireciona para o perfil do autor"></a>
    </footer>

    <script>
        function atualizarDataHora() {
            const dataHora = new Date();
            const local = navigator.language;

            let dataFormatada = dataHora.toLocaleDateString(local, { dateStyle: 'full' });
            const horaFormatada = dataHora.toLocaleTimeString(local, { timeStyle: 'medium' });

            dataFormatada = dataFormatada.charAt(0).toUpperCase() + dataFormatada.slice(1);
            document.getElementById('data').textContent = dataFormatada;
            document.getElementById('hora').textContent = horaFormatada;

            document.getElementById('data-dialog').textContent = dataFormatada;
            document.getElementById('hora-dialog').textContent = horaFormatada;
        }

        atualizarDataHora();
        setInterval(atualizarDataHora, 1000);

        const dialog = document.getElementById('dialog');
        const overlay = document.getElementById('overlay');
        const botaoFechar = document.getElementById('fechar');

        document.querySelector('.botao_ponto').addEventListener('click', () => {
            atualizarDataHora();
            overlay.classList.add('visible'); // Mostra o fundo depois de clicar no Registrar Ponto
            dialog.showModal();
            dialog.classList.add('animar-entrada');
            dialog.classList.remove('animar-saida');
        });

        botaoFechar.addEventListener('click', () => {
            dialog.classList.add('animar-saida');
            overlay.classList.remove('visible'); // Tira o fundo quando fecha(clica fora, no X ou ESC)
            setTimeout(() => dialog.close(), 500);
        });

        dialog.addEventListener('click', (event) => {
            if (event.target === dialog) {
                botaoFechar.click();
            }
        });

        overlay.addEventListener('click', () => {
            botaoFechar.click();
        });

        document.addEventListener('keydown', (event) => {
            if (event.key === 'Escape' && dialog.open) {
                botaoFechar.click();
            }
        });     //remove o fundo caso click ESC

        document.getElementById('entrada').addEventListener('click', () => {
            alert(`Entrada registrada em: ${document.getElementById('data-dialog').textContent} as ${document.getElementById('hora-dialog').textContent}`);
        });

        document.getElementById('saida').addEventListener('click', () => {
            alert(`Saida registrada em: ${document.getElementById('data-dialog').textContent} as ${document.getElementById('hora-dialog').textContent}`);
        });
    </script>
</body>
</html>
